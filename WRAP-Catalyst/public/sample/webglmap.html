<!DOCTYPE html>
<html style="width:100%; height:100%; margin:0; padding:0; font-family: 'Helvetica Neue', Helvetica, sans-serif !important; font-size: 13px;">
    <head>
        <meta charset="utf-8">
        <title>WRAP Venus WebGL Map Sample</title>
        <script src="https://maps.googleapis.com/maps/api/js?client=gme-weathernewsinc&libraries=geometry"></script>
        <script type="text/javascript" src="3rd/js/jquery-1.10.2.min.js"></script>
        <script type="text/javascript" src="js/WRAP.DH-1.2.0.0.js"></script>
        <script type="text/javascript" src="js/WRAP.Geo-1.2.0.0.js"></script>
        <script type="text/javascript" src="js/WRAP.ASM.js"></script>
        
    </head>
    <body style="width:100%; height:100%; margin:0; padding:0; background-color:rgb(255,255,255);">
        <div style="color:black; position:absolute; left:20px; top:8px;">WebGL Map Sample</div>
        <label style="position:absolute; width:260px; height:18px; left:200px; top:6px;">
            <input type="checkbox" id="gridline" checked><spawn id="label" style="position:absolute; top:2px; left:20px;">Grid Line</spawn>
        </label>
        <label style="position:absolute; width:260px; height:18px; left:300px; top:6px;">
            <input type="checkbox" id="airport" ><spawn id="label" style="position:absolute; top:2px; left:20px;">Airport</spawn>
        </label>
        <label style="position:absolute; width:260px; height:18px; left:400px; top:6px;">
            <input type="checkbox" id="coastline" checked><spawn id="label" style="position:absolute; top:2px; left:20px;">Coastline</spawn>
        </label>
<!--
        <a href="../doc/reference/sample_code/gridline.html" target="_blank" style="position:absolute; right:40px; top:8px;" >Document</a>
--> 
        <div id="map_canvas" style="position:absolute; top:30px; bottom:10px; left:10px; right:10px;"></div>

        <script type="text/javascript">
            // Mapの初期画角
            var initial_lat = 35.65;
            var initial_lon = 140.045;
            var initial_zoom = 3;
            var conf_path = "./pri/conf";     // ローカルの sample_data用コンフィグを用いる

            // Setup WebGLMap
            var w_map = document.getElementById('map_canvas');
///*
            WRAP.Geo.setWebGLMap(w_map);
            WRAP.Geo.setZoom(initial_zoom);
            WRAP.Geo.setCenterPoint(new WRAP.Geo.Point(initial_lat*60, initial_lon*60));
//*/
/*
            var g_map = new google.maps.Map(w_map, {
                zoom: initial_zoom,
                minZoom: 3,
                center: new google.maps.LatLng(initial_lat, initial_lon),
                zoomControl: true,
                mapTypeControl: false,
                scaleControl: false,
                streetViewControl: false,
                draggableCursor: "default",
                mapTypeId: google.maps.MapTypeId.ROADMAP
            });
            WRAP.Geo.setGoogleMaps(g_map)
*/
            
            WRAP.DH.conf_path = conf_path+"/data";
            var data = WRAP.DH.addObject("Airport");
            var world_coastline_data = WRAP.DH.addObject("Map_WorldCoastLine");
            
            
            // Layers
            var grid_layer = new WRAP.Geo.Layer("GridLine");
            var airport_layer = new WRAP.Geo.Layer("Airport");
            var world_coastline_layer = new WRAP.Geo.Layer("WorldCoastLine");
            WRAP.Geo.setLayer({
                upper_layers : [ airport_layer, world_coastline_layer, grid_layer ]
            });
                              
            // Configure Layers
            var conf_dir = "./pri/conf";
            $.getJSON(conf_dir + '/layer/Airport.json', function() {}).
                success(function(conf) {
                    airport_layer.configure(data, conf);
                }).
                error(function(jqXHR, textStatus, errorThrown) {
                    console.log("Layer configuration file load error : " + textStatus);
                });
            
            var conf_dir = "./pri/conf";
            $.getJSON(conf_dir + '/layer/GridLine.json', function() {}).
                success(function(conf) {
                    grid_layer.configure(null, conf);
                }).
                error(function(jqXHR, textStatus, errorThrown) {
                    console.log("GridLine Layer configuration file load error : " + textStatus);
                });
            
            $.getJSON(conf_dir + '/layer/WorldCoastLine.json', function() {}).
                success(function(conf) {
                    world_coastline_layer.configure(world_coastline_data, conf);
                }).
                error(function(jqXHR, textStatus, errorThrown) {
                    console.log("WorldCoastLine Layer configuration file load error : " + textStatus);
                });

            function updateLayer() {
                grid_layer.setVisible($('#gridline').prop('checked'));
                airport_layer.setVisible($('#airport').prop('checked'));
                world_coastline_layer.setVisible($('#coastline').prop('checked'));
            };

            // Tooltip
            WRAP.Geo.setInteraction(map_canvas);
            airport_layer.setTooltip(function(geo) {
                var p = geo && geo.properties;
                if ( p ) {
                    return p.name;
                }
            });
            
            $('input:checkbox').click(updateLayer);
            updateLayer();
            
        </script>
    </body>
</html>
